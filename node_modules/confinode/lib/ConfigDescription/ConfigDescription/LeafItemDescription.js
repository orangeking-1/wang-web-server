"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ConfinodeError_1 = require("../../ConfinodeError");
const ConfinodeResult_1 = require("../../ConfinodeResult");
/**
 * Description of a configuration leaf item.
 */
class LeafItemDescription {
    /**
     * Create a description of the leaf item.
     *
     * @param defaultValue - The value to use for inexistent value. If no default value given, the value is
     * mandatory in the configuration.
     */
    constructor(defaultValue) {
        this.defaultValue = defaultValue;
    }
    /**
     * Try and parse the value.
     *
     * @param data - The data currently being parsed.
     * @param context - The parsing context.
     * @returns The matching data node.
     */
    parse(data, context) {
        const { fileName, keyName, parent, final } = context;
        if (data !== undefined && data !== null) {
            return new ConfinodeResult_1.DirectResult(this.parseValue(data, fileName, keyName), fileName);
        }
        else if (data === undefined && parent) {
            return parent;
        }
        else if (!final) {
            return undefined;
        }
        else if (data === undefined && this.defaultValue !== undefined) {
            return new ConfinodeResult_1.DirectResult(this.defaultValue);
        }
        else {
            throw new ConfinodeError_1.default('missingMandatory', keyName);
        }
    }
}
exports.default = LeafItemDescription;
//# sourceMappingURL=LeafItemDescription.js.map